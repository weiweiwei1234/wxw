1、用户A选定一条适合加密的椭圆曲线Ep(a,b)(如:y2=x3+ax+b)，并取椭圆曲线上一点，作为基点G。
2、用户A选择一个私有密钥k，并生成公开密钥K=kG。
3、用户A将Ep(a,b)和点K，G传给用户B。
4、用户B接到信息后 ，将待传输的明文编码到Ep(a,b)上一点M，并产生一个随机整数r（r<n）。
5、用户B计算点C1=M+rK；C2=rG。
6、用户B将C1、C2传给用户A。
7、用户A接到信息后，计算C1-kC2，结果就是点M。因为
  C1-kC2=M+rK-k(rG)=M+rK-r(kG)=M
再对点M进行解码就可以得到明文。

推荐使用素数域256位椭圆曲线。
椭圆曲线方程：y2=x3+ax+b。
曲线参数
p=FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 FFFFFFFF FFFFFFFF
 a=FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 FFFFFFFF FFFFFFFC
 b=28E9FA9E 9D9F5E34 4D5A9E4B CF6509A7 F39789F5 15AB8F92 DDBCBD41 4D940E93
 n=FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF 7203DF6B 21C6052B 53BBF409 39D54123
 Gx=32C4AE2C 1F198119 5F990446 6A39C994 8FE30BBF F2660BE1 715A4589 334C74C7
 Gy=BC3736A2 F4F6779C 59BDCEE3 6B692153 D0A9877C C62A4740 02DF32E5 2139F0A0

 要将这些十六进制数转换为十进制，您可以按照以下步骤进行转换：

1.  将每个十六进制数分割成8个16位的块，每个块对应4个十六进制数字。例如，FFFFFFFE可以分割为FFFFFFFE。
2.  将每个16位块转换为十进制数。
3.  将所有的16位块连接起来，得到完整的十进制数。

现在，让我们按照上述步骤将给定的十六进制数转换为十进制数：

1.  将p转换为十进制：
    
    *   FFFFFFFE = 4294967294
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   00000000 = 0
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    
    因此，p = 4294967294 \* 2^224 + 4294967295 \* 2^192 + 4294967295 \* 2^160 + 4294967295 \* 2^128 + 4294967295 \* 2^96 + 4294967295 \* 2^64 + 0 \* 2^32 + 4294967295 
    = 115792089237316195423570985008687907853269984665640564039457584007913129639935。
    
2.  将a转换为十进制：
    
    *   FFFFFFFE = 4294967294
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   00000000 = 0
    *   FFFFFFFF = 4294967295
    *   FFFFFFFC = 4294967292
    
    因此，a = 115792089237316195423570985008687907853269984665640564039457584007913129639932。
    
3.  将b转换为十进制：
    
    *   28E9FA9E = 698504862
    *   9D9F5E34 = 2640100572
    *   4D5A9E4B = 129180163
    *   CF6509A7 = 3474438087
    *   F39789F5 = 4081362553
    *   15AB8F92 = 363937874
    *   DDBCBD41 = 3709155009
    *   4D940E93 = 1306634515
    
    因此，b = 698504862 \* 2^224 + 2640100572 \* 2^192 + 129180163 \* 2^160 + 3474438087 \* 2^128 + 4081362553 \* 2^96 + 363937874 \* 2^64 + 3709155009 \* 2^32 + 1306634515 
    = 41058363725152142129326129780047268409114441015993725554835256314039467401291。
    
4.  将n转换为十进制：
    
    *   FFFFFFFE = 4294967294
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   FFFFFFFF = 4294967295
    *   7203DF6B = 191751451
    *   21C6052B = 563995211
    *   53BBF409 = 1416927177
    *   39D54123 = 966886403
    
    因此，n = 4294967294 \* 2^224 + 4294967295 \* 2^192 + 4294967295 \* 2^160 + 4294967295 \* 2^128 + 191751451 \* 2^96 + 563995211 \* 2^64 + 1416927177 \* 2^32 + 966886403 
    = 115792089237316195423570985008687907853269984665640564039457584007913129639923。
    
5.  将Gx转换为十进制：
    
    *   32C4AE2C = 843956364
    *   1F198119 = 526568473
    *   5F990446 = 1591916310
    *   6A39C994 = 1781563380
    *   8FE30BBF = 2417454159
    *   F2660BE1 = 4071691713
    *   715A4589 = 1905184249
    *   334C74C7 = 858494087
    
    因此，Gx = 843956364 \* 2^224 + 526568473 \* 2^192 + 1591916310 \* 2^160 + 1781563380 \* 2^128 + 2417454159 \* 2^96 + 4071691713 \* 2^64 + 1905184249 \* 2^32 + 858494087 
    = 602046282375688656758213480587526111916698976636884684818。
    
6.  将Gy转换为十进制：
    
    *   BC3736A2 = 3156340210
    *   F4F6779C = 4129921548
    *   59BDCEE3 = 1492413649
    *   6B692153 = 1804684363
    *   D0A9877C = 3495438268
    *   C62A4740 = 3305791456
    *   02DF32E5 = 76408229
    *   2139F0A0 = 556702176
    
    因此，Gy = 3156340210 \* 2^224 + 4129921548 \* 2^192 + 1492413649 \* 2^160 + 1804684363 \* 2^128 + 3495438268 \* 2^96 + 3305791456 \* 2^64 + 76408229 \* 2^32 + 556702176 
    = 171943586981501236713555768347108872879680030001983424494933422011205721715898。

    // 定义椭圆曲线参数
unsigned long long p = 115792089237316195423570985008687907853269984665640564039457584007913129639935;
unsigned long long a = 115792089237316195423570985008687907853269984665640564039457584007913129639932;
unsigned long long b = 41058363725152142129326129780047268409114441015993725554835256314039467401291;
unsigned long long n = 115792089237316195423570985008687907853269984665640564039457584007913129639923;
unsigned long long Gx = 602046282375688656758213480587526111916698976636884684818;
unsigned long long Gy = 171943586981501236713555768347108872879680030001983424494933422011205721715898;

椭圆曲线倍点乘是密码学中常用的操作，可以通过一些加速方法提高计算效率。以下是几种常见的椭圆曲线倍点乘的加速方法：

1.  **Double-and-Add算法**：
    
    *   Double-and-Add算法是最基本的椭圆曲线倍点乘算法。该算法利用了二进制表示中的位操作，将点的倍乘操作分解为一系列加法和倍乘操作。
    *   算法步骤：
        1.  将倍数k表示为二进制形式。
        2.  从高位到低位遍历k的二进制表示，对每一位执行以下操作：
            *   如果该位为1，则进行点的加法操作。
            *   对点执行一次加法后，将点进行倍乘操作。
    *   Double-and-Add算法简单易实现，但可能存在侧信道攻击。
2.  **Montgomery Ladder算法**：
    
    *   Montgomery Ladder算法是一种更加安全和高效的椭圆曲线倍点乘算法。该算法不会泄露私密信息，并且抵抗侧信道攻击。
    *   算法步骤：
        1.  初始化两个点P和Q为无穷远点。
        2.  从高位到低位遍历倍数k的二进制表示，对每一位执行以下操作：
            *   如果该位为1，则执行点的加法操作 P = P + Q，否则执行点的加法和交换操作 Q = 2Q, P = P + Q。
        3.  返回点P作为结果。
    *   Montgomery Ladder算法具有更高的安全性和效率，可用于抵抗侧信道攻击。
3.  **Naf表示法**：
    
    *   Naf（Non-Adjacent Form）表示法是一种用于表示整数的方法，可以减少椭圆曲线倍点乘操作的计算量。
    *   Naf表示法将倍数k表示为一系列特定的数字，这些数字的绝对值不超过3，并且相邻的非零数字不相邻。通过Naf表示法，可以减少点加法的次数。
    *   在使用Naf表示法时，可以通过查表等方法来加速点的倍乘操作。

这些是常见的椭圆曲线倍点乘的加速方法，通过选择合适的算法和表示方法，可以提高椭圆曲线运算的效率和安全性。
